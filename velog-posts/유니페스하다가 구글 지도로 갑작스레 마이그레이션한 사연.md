<h3 id="문제가-발생했다">문제가 발생했다</h3>
<p>총학 페이지에서 부스를 이동하면 iOS에서 이상하게 나온다는 보고가 들어왔다. 무슨 일인지 확인해보자</p>
<p>&nbsp;</p>
<table>
<thead>
<tr>
<th>총학 페이지의 모습</th>
<th>iOS에서 확인했을 때의 모습</th>
</tr>
</thead>
<tbody><tr>
<td><img alt="이미지 1" src="https://velog.velcdn.com/images/ysj7191/post/19f58337-cc44-4358-b2c6-f7ef9a636b1c/image.png" /></td>
<td><img alt="이미지 2" src="https://velog.velcdn.com/images/ysj7191/post/bc082e66-5759-4403-b6dd-21d753f61bc5/image.png" width="480" /></td>
</tr>
</tbody></table>
<blockquote>
<p>총학 페이지를 기준으로 부스 위치를 배치했는데, 오른쪽 사진과 같이 iOS에서는 부스 위치가 엉뚱하게 운동장을 벗어나는 것처럼 보였다.</p>
</blockquote>
<p>&nbsp;</p>
<h3 id="도대체-뭐가-문제지">도대체 뭐가 문제지?</h3>
<p>좌표 문제인가? 라는 생각이 가장 먼저 들었다.
그럴 수는 없다. 백엔드 서버를 통해 동일한 위도와 경도를 기반으로 부스의 위치가 결정되는데 이게 잘못된 거라면 전 세계의 위도 경도를 사용하는 시스템에 문제가 있는 것이나 마찬가지다.
→ 혹시 모를 소수점이 반올림되는 현상도 아니었다. <strong>좌표에는 문제가 없다.</strong></p>
<p>그러던 중 한 가지 흥미로운 걸 발견했다.</p>
<table>
<thead>
<tr>
<th>네이버 지도</th>
<th>구글 위성 지도</th>
<th>구글 일반 지도</th>
</tr>
</thead>
<tbody><tr>
<td><img alt="" src="https://velog.velcdn.com/images/ysj7191/post/8af124ee-1c61-422d-9767-8f495b83c264/image.png" /></td>
<td><img alt="" src="https://velog.velcdn.com/images/ysj7191/post/946ae440-05db-42c1-bbe8-251e843e81ee/image.png" /></td>
<td><img alt="" src="https://velog.velcdn.com/images/ysj7191/post/d9204f3c-6e17-432a-99ae-1e54a9b74ed0/image.png" /></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>잘 보면 네이버 지도만 다른 점이 하나 있다. 바로 운동장의 범위에 조회대를 포함하였다는 것이다.</p>
<p>이로 인해 운동장의 범위에 대한 지도별 혼동이 생겼고, 이는 각 플랫폼 별로 다른 지도를 쓰고 있어서 생긴 문제였음을 확인하였다.</p>
<p>&nbsp;</p>
<h3 id="해결하는-가장-좋은-방법은-무엇일까">해결하는 가장 좋은 방법은 무엇일까?</h3>
<blockquote>
<p>적용가능한 방법은 2가지가 있다. </p>
</blockquote>
<ol>
<li>iOS가 네이버 지도로 마이그레이션한다. </li>
<li>총학웹이 네이버 지도 대신 구글 지도를 사용한다.</li>
</ol>
<ul>
<li><p>궁극적으로는 이런 상황을 방지하기 위한 네이버 지도로의 플랫폼 통일인데 서비스까지 남은 시간은 2주다. 남은 시간을 고려해야한다.</p>
</li>
<li><p>iOS의 경우 개발진이 싹 바뀌어서 기존의 코드들을 건드리기엔 부담이 크다.</p>
</li>
<li><p>따라서 현재로서는 총학 페이지에 있는 네이버 지도를 구글 지도로 바꾸면, 안드로이드에서는 좌측에 쏠려보이겠지만 실제로는 정확한 좌표이며, iOS에서도 올바르게 표시되니 문제가 없을 것으로 보였다.</p>
</li>
</ul>
<p>&nbsp;</p>
<h3 id="마이그레이션-하는-방법">마이그레이션 하는 방법</h3>
<ul>
<li>일단 기존에 사용하던 naver.map 의 네임스페이스를 지웠다.</li>
<li>그러면 사용하던 곳에서 다 에러가 뜰건데 각각을 하나의 단계로 나누고 주석처리해서 하나씩 해결해나갔다.<ul>
<li>ex) 부스 목록 저장, 마커로의 전환</li>
</ul>
</li>
<li>이 과정에서 Google Map은 기존에 있던 객체 (google.maps.Marker)의 사용을 Deprecated 하였기 때문에 선언형 UI로 최대한 코딩하고자했다.</li>
</ul>
<h3 id="트러블슈팅">트러블슈팅</h3>
<p><strong>for development purposes only</strong>
<img alt="" src="https://velog.velcdn.com/images/ysj7191/post/32aa6419-fcd2-4771-b1e9-34fbc8a7d356/image.png" />
Key가 잘 들어갔는지 확인해야한다. 또는 웹사이트 리퍼러가 제대로 설정되었는지 보아야한다.</p>
<p>다 잘 되어있다고 생각했는데 Github Actions 워크플로우의 환경변수 주입과정에서 Key 이름이 잘못되어 있었다... (VITE_GOOGLE_MAPS_KEY인데 VITE_GOOGLE_MAP_KEY로..)</p>